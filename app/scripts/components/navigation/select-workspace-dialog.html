<div class="modal-header">
    <h3 class="modal-title">Select workspace</h3>
</div>
<div class="modal-body" ng-class="{disabled: Ctrl.loadingState}">
  <div ng-if="Ctrl.loadingOrganizations">
      <h1 class="text-center"><i class="icon fa-spinner fa-spin"></i></h1>
  </div>
  <div ng-if="!Ctrl.loadingOrganizations && Ctrl.organizations.length === 0" class="row">
    <div class="middle-box text-center">
        <h3 class="font-bold m-b-lg">
          You do not belong to any organisation yet.
        </h3>
        <div>
            <a class="btn btn-default"
              ng-click="Ctrl.createOrganization()"
              ng-if="Ctrl.canCreateOrganization">
              <i class="fa fa-plus"></i>
              Add new organization
            </a>
        </div>
    </div>
  </div>
  <div ng-if="!Ctrl.loadingOrganizations && Ctrl.organizations.length > 0" class="row">
    <div class="col-md-6 col-xs-12 m-b-md">
      <a class="pull-right btn btn-sm btn-default"
        ng-click="Ctrl.createOrganization()"
        ng-if="Ctrl.canCreateOrganization">
        <i class="fa fa-plus"></i>
        Add new <span class="hidden-xs">organization</span>
      </a>
      <h3 class="m-b-md">
        Organizations ({{ Ctrl.organizations.length }})
      </h3>
      <div class="form-group">
        <div class="search-box">
          <input id="organization-search-box"
                 type="text"
                 class="form-control" 
                 ng-model="Ctrl.organizationSearchInput"
                 ng-model-options="{ debounce: 500 }"
                 placeholder="Filter organizations">
          <label for="organization-search-box">
            <i class="fa fa-search"></i>
          </label>
        </div>
      </div>
      <div class="list-group" slimscroll="{alwaysVisible: true, height: '300px'}">
        <div class="list-group-item"
          ng-repeat="organization in Ctrl.organizations | filter: {name: Ctrl.organizationSearchInput}"
          ng-class="{active: organization.uuid == Ctrl.selectedOrganization.uuid}"
          ng-click="Ctrl.selectOrganization(organization)">
          <a class="btn btn-xs btn-default pull-right"
            ng-if="organization.ownerOrStaff"
            submit-button="Ctrl.gotoOrganization(organization)">
            Select
          </a>
          <div
            class="elipsis"
            ng-if="organization.abbreviation"
            uib-tooltip="{{ organization.name }}"
            tooltip-append-to-body="true"
            tooltip-class="navigation-tooltip-order"
            ng-bind="organization.abbreviation"></div>
          <div
            class="elipsis"
            ng-if="!organization.abbreviation"
            ng-bind="organization.name"></div>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-xs-12">
      <a class="pull-right btn btn-sm btn-default"
        ng-click="Ctrl.createProject()"
        ng-if="Ctrl.selectedOrganization.ownerOrStaff">
        <i class="fa fa-plus"></i>
        Add new project
      </a>
      <h3 class="m-b-md">
        Projects ({{ Ctrl.selectedOrganization.projects.length }})
      </h3>
      <div class="form-group">
        <div class="search-box">
          <input id="project-search-box"
                 type="text"
                 class="form-control" 
                 ng-model="Ctrl.projectSearchInput"
                 ng-model-options="{ debounce: 500 }"
                 placeholder="Filter projects">
          <label for="project-search-box">
            <i class="fa fa-search"></i>
          </label>
        </div>
      </div>
      <div ng-if="Ctrl.selectedOrganization.projects.length == 0">
          <p class="text-center text-danger">There are no projects yet for this organization.</p>
      </div>
      <div ng-if="Ctrl.selectedOrganization.projects.length > 0"
        class="list-group"
        slimscroll="{alwaysVisible: true, height: '300px'}">
        <div class="list-group-item"
          ng-repeat="project in Ctrl.selectedOrganization.projects | filter: {name: Ctrl.projectSearchInput}"
          ng-class="{active: project.uuid == Ctrl.selectedProject.uuid}"
          ng-click="Ctrl.selectProject(project)">
          <a class="btn btn-xs btn-default pull-right" submit-button="Ctrl.gotoProject(project)">
            Select
          </a>
          <div class="elipsis">{{ project.name }}</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal-footer">
    <button class="btn btn-default" ng-click="Ctrl.gotoProfile()">
      Go to my profile
    </button>
    <button class="btn btn-default" ng-click="Ctrl.dismiss()">
      Cancel
    </button>
</div>
