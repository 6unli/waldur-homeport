<div class="ibox float-e-margins">
    <div class="ibox-title">
        <h5>Create request</h5>
    </div>
    <div class="ibox-content">
        <form name="$ctrl.IssueForm" ng-disabled="$ctrl.saving">
            <div class="form-group">
                <label for="issueType" class="control-label">
                    Request type <span class="text-danger">*</span>
                </label>
                <div>
                    <ui-select ng-model="$ctrl.issue.type" name="type" required>
                        <ui-select-match placeholder="Select request type..."
                                         allow-clear="true">
                            <i class="fa" ng-class="[$select.selected.iconClass, $select.selected.textClass]"></i>
                            {{ $select.selected.label }}
                        </ui-select-match>
                        <ui-select-choices repeat="option in $ctrl.types">
                            <i class="fa" ng-class="[option.iconClass, option.textClass]"></i>
                            {{ option.label }}
                        </ui-select-choices>
                    </ui-select>
                    <div class="help-block text-danger"
                         ng-if="($ctrl.IssueForm.$submitted || $ctrl.IssueForm.type.$touched) && $ctrl.IssueForm.type.$error.required">
                        You did not enter a field
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="issueSummary" class="control-label">
                    Title <span class="text-danger">*</span>
                </label>
                <div>
                    <input type="text"
                        id="issueSummary"
                        ng-model="$ctrl.issue.summary"
                        class="form-control"
                        name="summary" required>
                    <div class="help-block text-danger"
                         ng-if="($ctrl.IssueForm.$submitted || $ctrl.IssueForm.summary.$touched) && $ctrl.IssueForm.summary.$error.required">
                        You did not enter a field
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="issueDescription" class="control-label">
                    Description <span class="text-danger">*</span>
                </label>
                <div>
                    <textarea type="text"
                        id="issueDescription"
                        ng-model="$ctrl.issue.description"
                        class="form-control"
                        name="description" required/>
                    <div class="help-block text-danger"
                         ng-if="($ctrl.IssueForm.$submitted || $ctrl.IssueForm.description.$touched) && $ctrl.IssueForm.description.$error.required">
                        You did not enter a field
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label">
                    Organization
                </label>
                <div>
                    <ui-select ng-model="$ctrl.issue.customer" name="customer">
                        <ui-select-match placeholder="Select organization..."
                                         allow-clear="true">
                            {{ $select.selected.name }}
                        </ui-select-match>
                        <ui-select-choices repeat="option in $ctrl.customers"
                                           refresh="$ctrl.refreshCustomers($select.search)"
                                           refresh-delay="0"
                                           spinner-enabled="true">
                            {{ option.name }}
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label">
                    Project
                </label>
                <div ng-class="{disabled: !$ctrl.issue.customer}">
                    <ui-select ng-model="$ctrl.issue.project" name="project">
                        <ui-select-match placeholder="Select project..."
                                         allow-clear="true">
                            {{ $select.selected.name }}
                        </ui-select-match>
                        <ui-select-choices repeat="option in $ctrl.projects"
                                           refresh="$ctrl.refreshProjects($select.search)"
                                           refresh-delay="0"
                                           spinner-enabled="true">
                            {{ option.name }}
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label">
                    Affected resource
                </label>
                <div ng-class="{disabled: !$ctrl.issue.project}">
                    <ui-select ng-model="$ctrl.issue.resource">
                        <ui-select-match placeholder="Select affected resource..."
                                         allow-clear="true">
                            {{ $select.selected.name }}
                        </ui-select-match>
                        <ui-select-choices repeat="option in $ctrl.resources"
                                           refresh="$ctrl.refreshResources($select.search)"
                                           refresh-delay="0"
                                           spinner-enabled="true">
                            {{ option.name }}
                        </ui-select-choices>
                    </ui-select>
                </div>
            </div>
            <div class="text-right">
                <a class="btn btn-primary"
                    submit-button="$ctrl.save()"
                    type="submit">
                    <i class="fa fa fa-plus"></i>
                    Create request
                </a>
            </div>
        </form>
    </div>
</div>
