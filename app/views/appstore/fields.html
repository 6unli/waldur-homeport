<div class="form-horizontal">
<div ng-repeat="field in AppStore.fields"
     ng-switch="field.type">

    <div class="form-group" ng-switch-when="boolean">
        <div class="col-sm-offset-3 col-sm-4">
            <div class="awesome-checkbox checkbox-success">
                <input type="checkbox"
                    ng-model="AppStore.instance[field.name]"
                    id="checkbox-{{ $index }}"/>
                <label for="checkbox-{{ $index }}">
                    <field-label field="field"></field-label>
                </label>
            </div>
        </div>
    </div>

    <div ng-switch-when="string">
        <div ng-if="field.name === 'password'">
            <div class="form-group">
                <label for="{{ field.name }}" class="col-sm-3 control-label">
                    <helpicon help-text="{{ field.help_text }}" ng-if="field.help_text"></helpicon>
                    <field-label field="field"></field-label>
                </label>
                <div class="col-sm-4">
                    <input ng-hide="true" type="password" id="dummyPassword" />
                    <input class="form-control" type="password" id="{{ field.name }}" ng-model="AppStore.instance[field.name]"/>
                </div>
            </div>
            <div class="form-group">
                <label for="repeat_password" class="col-sm-3 control-label">
                    Repeat password
                </label>
                <div class="col-sm-4">
                    <input class="form-control" type="password" id="repeat_password" ng-model="AppStore.instance['repeat_password']"/>
                </div>
            </div>
        </div>
        <div ng-if="field.name !== 'password'">
            <div class="form-group">
                <label for="{{ field.name }}" class="col-sm-3 control-label">
                    <helpicon help-text="{{ field.help_text }}" ng-if="field.help_text"></helpicon>
                    <field-label field="field"></field-label>
                </label>
                <div class="col-sm-4">
                    <!--XXX: fix for SAAS-1022 task-->
                    <input type="text" class="form-control" id="{{ field.name }}" ng-model="AppStore.instance[field.name]"/>
                </div>
            </div>
        </div>
        <div class="error arrow-up" ng-show="AppStore.errors[field.name]">
            <ul class="error-list">
                <li ng-repeat="error in AppStore.errors[field.name]" ng-bind="error"></li>
            </ul>
        </div>
    </div>

    <div class="form-group" ng-switch-when="text">
        <label for="{{ field.name }}" class="col-sm-3 control-label">
            <helpicon help-text="{{ field.help_text }}" ng-if="field.help_text"></helpicon>
            <field-label field="field"></field-label>
        </label>
        <div class="col-sm-4">
            <textarea id="{{ field.name }}" ng-model="AppStore.instance[field.name]" class="form-control"></textarea>
            <div class="error arrow-up" ng-show="AppStore.errors[field.name]">
                <ul class="error-list">
                    <li ng-repeat="error in AppStore.errors[field.name]" ng-bind="error"></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="form-group" ng-switch-when="integer">
        <div class="col-sm-3 control-label">
            <label for="{{ field.name }}">
                <helpicon help-text="{{ field.help_text }}" ng-if="field.help_text"></helpicon>
                <field-label field="field"></field-label>
            </label>
        </div>
        <div class="col-sm-4">
            <div class="input-group">
                <input type="number"
                       min="{{ field.min }}"
                       max="{{ field.max }}"
                       id="{{ field.name }}"
                       ng-model="AppStore.instance[field.name]"
                       ng-init="AppStore.instance[field.name]=field.min"
                       class="form-control"/>
                <span class="input-group-addon">{{ field.units }}</span>
            </div>
            <div class="error arrow-up" ng-show="AppStore.errors[field.name]">
                <ul class="error-list">
                    <li ng-repeat="error in AppStore.errors[field.name]" ng-bind="error"></li>
                </ul>
            </div>
        </div>
    </div>

    <div ng-switch-when="choice">
        <div ng-if="field.required && !field.choices.length" class="form-group">
            <label class="col-sm-3 control-label" ng-bind="field.label"></label>
            <div class="col-sm-4 form-control-static text-danger">
                <span ng-if="field.name!='ssh_public_key'">
                    {{ field.label }} is required for provisioning resource.
                </span>
                <span ng-if="field.name =='ssh_public_key'">
                    SSH public key is required for accessing a provisioned VM.
                    You can add a key in your <a ui-sref="profile.details">profile</a>.
                </span>
            </div>
        </div>
        <div ng-if="field.choices.length" class="form-group">
            <label class="col-sm-3 control-label">
                <field-label field="field"/>
            </label>
            <div class="col-sm-4">
                <p class="form-control-static">
                    <a ng-click="AppStore.modalInit(field)">
                        {{ AppStore.choiceDisplay[field.name] || 'Show choices' }}
                        <i class="icon fa-caret-down"></i>
                    </a>
                </p>
            </div>
            <div class="select-image-wrapper"
                 ng-if="field.showChoices"
                 add-body-class="disable-scroll">
                <div class="select-image-popup">
                    <h3>Select {{ field.label }}</h3>
                    <form>
                        <div class="string-field">
                        <input type="text" placeholder="Type to filter by name"
                               ng-model="field.searchQuery" ng-init="field.searchQuery=''"
                               class="form-control" />
                        </div>
                    </form>

                    <div class="appstore-templates">
                        <div class="white-box list-box">
                            <ul class="object-list">
                                <li class="list-item list"
                                    ng-repeat="choice in field.choices | filter: {'display_name': field.searchQuery}"
                                    ng-click="AppStore.doChoice(field, choice)"
                                    ng-class="{'state': AppStore.isChosen(field.name, choice), 'disabled': choice.disabled}">
                                    <div ng-if="::!choice.icon" class="icon {{ ::field.icon }}"></div>
                                    <div ng-if="::choice.icon" class="icon">
                                        <img ng-src="/static/images/appstore/icon-{{ ::choice.icon }}.png">
                                    </div>

                                    <div class="description-{{::field.name}}">
                                        <div>
                                            <p>{{ choice.display_name }}</p>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="clear"></div>
                    <div class="control-buttons">
                        <a class="button-apply" ng-click="AppStore.closeModal(field)">OK</a>
                        <a class="button-cancel" ng-click="AppStore.closeModal(field)">Close</a>
                        <a class="button-cancel" ng-click="AppStore.resetChoice(field)">Reset</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
